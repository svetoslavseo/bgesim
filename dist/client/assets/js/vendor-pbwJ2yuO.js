import{g as ce,c as be,a as Je}from"./react-vendor-DmWjGKy8.js";function He(o,g){for(var a=0;a<g.length;a++){const t=g[a];if(typeof t!="string"&&!Array.isArray(t)){for(const u in t)if(u!=="default"&&!(u in o)){const i=Object.getOwnPropertyDescriptor(t,u);i&&Object.defineProperty(o,u,i.get?i:{enumerable:!0,get:()=>t[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}var he={exports:{}},de={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ke;function Xe(){return ke||(ke=1,function(o){function g(l,b){var _=l.length;l.push(b);e:for(;0<_;){var x=_-1>>>1,R=l[x];if(0<u(R,b))l[x]=b,l[_]=R,_=x;else break e}}function a(l){return l.length===0?null:l[0]}function t(l){if(l.length===0)return null;var b=l[0],_=l.pop();if(_!==b){l[0]=_;e:for(var x=0,R=l.length,P=R>>>1;x<P;){var q=2*(x+1)-1,fe=l[q],N=q+1,re=l[N];if(0>u(fe,_))N<R&&0>u(re,fe)?(l[x]=re,l[N]=_,x=N):(l[x]=fe,l[q]=_,x=q);else if(N<R&&0>u(re,_))l[x]=re,l[N]=_,x=N;else break e}}return b}function u(l,b){var _=l.sortIndex-b.sortIndex;return _!==0?_:l.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;o.unstable_now=function(){return i.now()}}else{var h=Date,d=h.now();o.unstable_now=function(){return h.now()-d}}var y=[],v=[],p=1,m=null,n=3,s=!1,c=!1,r=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(l){for(var b=a(v);b!==null;){if(b.callback===null)t(v);else if(b.startTime<=l)t(v),b.sortIndex=b.expirationTime,g(y,b);else break;b=a(v)}}function E(l){if(r=!1,D(l),!c)if(a(y)!==null)c=!0,f(A);else{var b=a(v);b!==null&&T(E,b.startTime-l)}}function A(l,b){c=!1,r&&(r=!1,k(C),C=-1),s=!0;var _=n;try{for(D(b),m=a(y);m!==null&&(!(m.expirationTime>b)||l&&!te());){var x=m.callback;if(typeof x=="function"){m.callback=null,n=m.priorityLevel;var R=x(m.expirationTime<=b);b=o.unstable_now(),typeof R=="function"?m.callback=R:m===a(y)&&t(y),D(b)}else t(y);m=a(y)}if(m!==null)var P=!0;else{var q=a(v);q!==null&&T(E,q.startTime-b),P=!1}return P}finally{m=null,n=_,s=!1}}var B=!1,S=null,C=-1,I=5,ee=-1;function te(){return!(o.unstable_now()-ee<I)}function O(){if(S!==null){var l=o.unstable_now();ee=l;var b=!0;try{b=S(!0,l)}finally{b?j():(B=!1,S=null)}}else B=!1}var j;if(typeof M=="function")j=function(){M(O)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,e=W.port2;W.port1.onmessage=O,j=function(){e.postMessage(null)}}else j=function(){w(O,0)};function f(l){S=l,B||(B=!0,j())}function T(l,b){C=w(function(){l(o.unstable_now())},b)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(l){l.callback=null},o.unstable_continueExecution=function(){c||s||(c=!0,f(A))},o.unstable_forceFrameRate=function(l){0>l||125<l?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<l?Math.floor(1e3/l):5},o.unstable_getCurrentPriorityLevel=function(){return n},o.unstable_getFirstCallbackNode=function(){return a(y)},o.unstable_next=function(l){switch(n){case 1:case 2:case 3:var b=3;break;default:b=n}var _=n;n=b;try{return l()}finally{n=_}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(l,b){switch(l){case 1:case 2:case 3:case 4:case 5:break;default:l=3}var _=n;n=l;try{return b()}finally{n=_}},o.unstable_scheduleCallback=function(l,b,_){var x=o.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?x+_:x):_=x,l){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=_+R,l={id:p++,callback:b,priorityLevel:l,startTime:_,expirationTime:R,sortIndex:-1},_>x?(l.sortIndex=_,g(v,l),a(y)===null&&l===a(v)&&(r?(k(C),C=-1):r=!0,T(E,_-x))):(l.sortIndex=R,g(y,l),c||s||(c=!0,f(A))),l},o.unstable_shouldYield=te,o.unstable_wrapCallback=function(l){var b=n;return function(){var _=n;n=b;try{return l.apply(this,arguments)}finally{n=_}}}}(de)),de}var Te;function _t(){return Te||(Te=1,he.exports=Xe()),he.exports}var me,Me;function Ke(){if(Me)return me;Me=1;var o=function(g,a,t,u,i,h,d,y){if(!g){var v;if(a===void 0)v=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var p=[t,u,i,h,d,y],m=0;v=new Error(a.replace(/%s/g,function(){return p[m++]})),v.name="Invariant Violation"}throw v.framesToPop=1,v}};return me=o,me}var Qe=Ke();const gt=ce(Qe);var ye,xe;function Ye(){return xe||(xe=1,ye=function(g,a,t,u){var i=t?t.call(u,g,a):void 0;if(i!==void 0)return!!i;if(g===a)return!0;if(typeof g!="object"||!g||typeof a!="object"||!a)return!1;var h=Object.keys(g),d=Object.keys(a);if(h.length!==d.length)return!1;for(var y=Object.prototype.hasOwnProperty.bind(a),v=0;v<h.length;v++){var p=h[v];if(!y(p))return!1;var m=g[p],n=a[p];if(i=t?t.call(u,m,n,p):void 0,i===!1||i===void 0&&m!==n)return!1}return!0}),ye}var et=Ye();const wt=ce(et);var ne={exports:{}},Ee;function tt(){return Ee||(Ee=1,function(o,g){var a=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof be<"u"&&be,t=function(){function i(){this.fetch=!1,this.DOMException=a.DOMException}return i.prototype=a,new i}();(function(i){(function(h){var d=typeof i<"u"&&i||typeof self<"u"&&self||typeof d<"u"&&d,y={searchParams:"URLSearchParams"in d,iterable:"Symbol"in d&&"iterator"in Symbol,blob:"FileReader"in d&&"Blob"in d&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in d,arrayBuffer:"ArrayBuffer"in d};function v(e){return e&&DataView.prototype.isPrototypeOf(e)}if(y.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(e){return e&&p.indexOf(Object.prototype.toString.call(e))>-1};function n(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function s(e){return typeof e!="string"&&(e=String(e)),e}function c(e){var f={next:function(){var T=e.shift();return{done:T===void 0,value:T}}};return y.iterable&&(f[Symbol.iterator]=function(){return f}),f}function r(e){this.map={},e instanceof r?e.forEach(function(f,T){this.append(T,f)},this):Array.isArray(e)?e.forEach(function(f){this.append(f[0],f[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(f){this.append(f,e[f])},this)}r.prototype.append=function(e,f){e=n(e),f=s(f);var T=this.map[e];this.map[e]=T?T+", "+f:f},r.prototype.delete=function(e){delete this.map[n(e)]},r.prototype.get=function(e){return e=n(e),this.has(e)?this.map[e]:null},r.prototype.has=function(e){return this.map.hasOwnProperty(n(e))},r.prototype.set=function(e,f){this.map[n(e)]=s(f)},r.prototype.forEach=function(e,f){for(var T in this.map)this.map.hasOwnProperty(T)&&e.call(f,this.map[T],T,this)},r.prototype.keys=function(){var e=[];return this.forEach(function(f,T){e.push(T)}),c(e)},r.prototype.values=function(){var e=[];return this.forEach(function(f){e.push(f)}),c(e)},r.prototype.entries=function(){var e=[];return this.forEach(function(f,T){e.push([T,f])}),c(e)},y.iterable&&(r.prototype[Symbol.iterator]=r.prototype.entries);function w(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function k(e){return new Promise(function(f,T){e.onload=function(){f(e.result)},e.onerror=function(){T(e.error)}})}function M(e){var f=new FileReader,T=k(f);return f.readAsArrayBuffer(e),T}function D(e){var f=new FileReader,T=k(f);return f.readAsText(e),T}function E(e){for(var f=new Uint8Array(e),T=new Array(f.length),l=0;l<f.length;l++)T[l]=String.fromCharCode(f[l]);return T.join("")}function A(e){if(e.slice)return e.slice(0);var f=new Uint8Array(e.byteLength);return f.set(new Uint8Array(e)),f.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:y.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:y.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():y.arrayBuffer&&y.blob&&v(e)?(this._bodyArrayBuffer=A(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||m(e))?this._bodyArrayBuffer=A(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var e=w(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=w(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(M)}),this.text=function(){var e=w(this);if(e)return e;if(this._bodyBlob)return D(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(E(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(e){var f=e.toUpperCase();return S.indexOf(f)>-1?f:e}function I(e,f){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');f=f||{};var T=f.body;if(e instanceof I){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,f.headers||(this.headers=new r(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!T&&e._bodyInit!=null&&(T=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=f.credentials||this.credentials||"same-origin",(f.headers||!this.headers)&&(this.headers=new r(f.headers)),this.method=C(f.method||this.method||"GET"),this.mode=f.mode||this.mode||null,this.signal=f.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&T)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(T),(this.method==="GET"||this.method==="HEAD")&&(f.cache==="no-store"||f.cache==="no-cache")){var l=/([?&])_=[^&]*/;if(l.test(this.url))this.url=this.url.replace(l,"$1_="+new Date().getTime());else{var b=/\?/;this.url+=(b.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function ee(e){var f=new FormData;return e.trim().split("&").forEach(function(T){if(T){var l=T.split("="),b=l.shift().replace(/\+/g," "),_=l.join("=").replace(/\+/g," ");f.append(decodeURIComponent(b),decodeURIComponent(_))}}),f}function te(e){var f=new r,T=e.replace(/\r?\n[\t ]+/g," ");return T.split("\r").map(function(l){return l.indexOf(`
`)===0?l.substr(1,l.length):l}).forEach(function(l){var b=l.split(":"),_=b.shift().trim();if(_){var x=b.join(":").trim();f.append(_,x)}}),f}B.call(I.prototype);function O(e,f){if(!(this instanceof O))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');f||(f={}),this.type="default",this.status=f.status===void 0?200:f.status,this.ok=this.status>=200&&this.status<300,this.statusText=f.statusText===void 0?"":""+f.statusText,this.headers=new r(f.headers),this.url=f.url||"",this._initBody(e)}B.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},O.error=function(){var e=new O(null,{status:0,statusText:""});return e.type="error",e};var j=[301,302,303,307,308];O.redirect=function(e,f){if(j.indexOf(f)===-1)throw new RangeError("Invalid status code");return new O(null,{status:f,headers:{location:e}})},h.DOMException=d.DOMException;try{new h.DOMException}catch{h.DOMException=function(f,T){this.message=f,this.name=T;var l=Error(f);this.stack=l.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function W(e,f){return new Promise(function(T,l){var b=new I(e,f);if(b.signal&&b.signal.aborted)return l(new h.DOMException("Aborted","AbortError"));var _=new XMLHttpRequest;function x(){_.abort()}_.onload=function(){var P={status:_.status,statusText:_.statusText,headers:te(_.getAllResponseHeaders()||"")};P.url="responseURL"in _?_.responseURL:P.headers.get("X-Request-URL");var q="response"in _?_.response:_.responseText;setTimeout(function(){T(new O(q,P))},0)},_.onerror=function(){setTimeout(function(){l(new TypeError("Network request failed"))},0)},_.ontimeout=function(){setTimeout(function(){l(new TypeError("Network request failed"))},0)},_.onabort=function(){setTimeout(function(){l(new h.DOMException("Aborted","AbortError"))},0)};function R(P){try{return P===""&&d.location.href?d.location.href:P}catch{return P}}_.open(b.method,R(b.url),!0),b.credentials==="include"?_.withCredentials=!0:b.credentials==="omit"&&(_.withCredentials=!1),"responseType"in _&&(y.blob?_.responseType="blob":y.arrayBuffer&&b.headers.get("Content-Type")&&b.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(_.responseType="arraybuffer")),f&&typeof f.headers=="object"&&!(f.headers instanceof r)?Object.getOwnPropertyNames(f.headers).forEach(function(P){_.setRequestHeader(P,s(f.headers[P]))}):b.headers.forEach(function(P,q){_.setRequestHeader(q,P)}),b.signal&&(b.signal.addEventListener("abort",x),_.onreadystatechange=function(){_.readyState===4&&b.signal.removeEventListener("abort",x)}),_.send(typeof b._bodyInit>"u"?null:b._bodyInit)})}return W.polyfill=!0,d.fetch||(d.fetch=W,d.Headers=r,d.Request=I,d.Response=O),h.Headers=r,h.Request=I,h.Response=O,h.fetch=W,h})({})})(t),t.fetch.ponyfill=!0,delete t.fetch.polyfill;var u=a.fetch?a:t;g=u.fetch,g.default=u.fetch,g.fetch=u.fetch,g.Headers=u.Headers,g.Request=u.Request,g.Response=u.Response,o.exports=g}(ne,ne.exports)),ne.exports}var Ge=tt();const rt=ce(Ge),bt=He({__proto__:null,default:rt},[Ge]),nt={},it=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"}));var J={},$={};const U=Je(it);var z={},H={},De;function pe(){if(De)return H;De=1;var o=H&&H.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(H,"__esModule",{value:!0}),H.createID=a;const g=o(U);function a(t="",u=16){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",h=g.default.randomBytes(u),d=Array.from(h,y=>i[y%i.length]).join("");return t?`${t}-${d}`:d}return H}var ie={},Re;function ve(){if(Re)return ie;Re=1,Object.defineProperty(ie,"__esModule",{value:!0});const o={INFO:"\x1B[36m",WARN:"\x1B[33m",ERROR:"\x1B[31m",DEBUG:"\x1B[35m"},g="\x1B[32m",a="\x1B[0m";function t(i,h,d){const y=new Date().toISOString(),v=o[i]??"",m=`${`[${y}] [PID: ${process.pid}] ${g}[NODE-CRON]${g} ${v}[${i}]${a}`} ${h}`;switch(i){case"ERROR":console.error(m,d??"");break;case"DEBUG":console.debug(m,d??"");break;case"WARN":console.warn(m);break;case"INFO":default:console.info(m);break}}const u={info(i){t("INFO",i)},warn(i){t("WARN",i)},error(i,h){i instanceof Error?t("ERROR",i.message,i):t("ERROR",i,h)},debug(i,h){i instanceof Error?t("DEBUG",i.message,i):t("DEBUG",i,h)}};return ie.default=u,ie}var X={},Pe;function ot(){if(Pe)return X;Pe=1,Object.defineProperty(X,"__esModule",{value:!0}),X.TrackedPromise=void 0;class o{promise;error;state;value;constructor(a){this.state="pending",this.promise=new Promise((t,u)=>{a(i=>{this.state="fulfilled",this.value=i,t(i)},i=>{this.state="rejected",this.error=i,u(i)})})}getPromise(){return this.promise}getState(){return this.state}isPending(){return this.state==="pending"}isFulfilled(){return this.state==="fulfilled"}isRejected(){return this.state==="rejected"}getValue(){return this.value}getError(){return this.error}then(a,t){return this.promise.then(a,t)}catch(a){return this.promise.catch(a)}finally(a){return this.promise.finally(a)}}return X.TrackedPromise=o,X}var Oe;function st(){if(Oe)return z;Oe=1;var o=z&&z.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(z,"__esModule",{value:!0}),z.Runner=void 0;const g=pe(),a=o(ve()),t=ot();function u(){}function i(){return!0}function h(m,n){a.default.error("Task failed with error!",n)}class d{timeMatcher;onMatch;noOverlap;maxExecutions;maxRandomDelay;runCount;running;heartBeatTimeout;onMissedExecution;onOverlap;onError;beforeRun;onFinished;onMaxExecutions;constructor(n,s,c){this.timeMatcher=n,this.onMatch=s,this.noOverlap=c==null||c.noOverlap===void 0?!1:c.noOverlap,this.maxExecutions=c?.maxExecutions,this.maxRandomDelay=c?.maxRandomDelay||0,this.onMissedExecution=c?.onMissedExecution||u,this.onOverlap=c?.onOverlap||u,this.onError=c?.onError||h,this.onFinished=c?.onFinished||i,this.beforeRun=c?.beforeRun||i,this.onMaxExecutions=c?.onMaxExecutions||u,this.runCount=0,this.running=!1}start(){this.running=!0;let n,s;const c=M=>{this.running&&(clearTimeout(this.heartBeatTimeout),this.heartBeatTimeout=setTimeout(k,v(this.timeMatcher,M)))},r=M=>new Promise(async D=>{const E={id:(0,g.createID)("exec"),reason:"scheduled"},A=await this.beforeRun(M,E),B=Math.floor(Math.random()*this.maxRandomDelay);A&&setTimeout(async()=>{try{this.runCount++,E.startedAt=new Date;const S=await this.onMatch(M,E);E.finishedAt=new Date,E.result=S,this.onFinished(M,E),this.maxExecutions&&this.runCount>=this.maxExecutions&&(this.onMaxExecutions(M),this.stop())}catch(S){E.finishedAt=new Date,E.error=S,this.onError(M,S,E)}D(!0)},B)}),w=M=>new t.TrackedPromise(async(D,E)=>{try{this.timeMatcher.match(M)&&await r(M),D(!0)}catch(A){E(A)}}),k=async()=>{const M=p();if(s&&s.getTime()<M.getTime())for(;s.getTime()<M.getTime();)a.default.warn(`missed execution at ${s}! Possible blocking IO or high CPU user at the same process used by node-cron.`),s=this.timeMatcher.getNextMatch(s),y(this.onMissedExecution,s,h);if(n&&n.getState()==="pending"&&(y(this.onOverlap,M,h),this.noOverlap)){a.default.warn("task still running, new execution blocked by overlap prevention!"),s=this.timeMatcher.getNextMatch(M),c(M);return}n=w(M),s=this.timeMatcher.getNextMatch(M),c(M)};this.heartBeatTimeout=setTimeout(()=>{k()},v(this.timeMatcher,p()))}nextRun(){return this.timeMatcher.getNextMatch(new Date)}stop(){this.running=!1,this.heartBeatTimeout&&(clearTimeout(this.heartBeatTimeout),this.heartBeatTimeout=void 0)}isStarted(){return!!this.heartBeatTimeout&&this.running}isStopped(){return!this.isStarted()}async execute(){const n=new Date,s={id:(0,g.createID)("exec"),reason:"invoked"};try{if(await this.beforeRun(n,s)){this.runCount++,s.startedAt=new Date;const r=await this.onMatch(n,s);s.finishedAt=new Date,s.result=r,this.onFinished(n,s)}}catch(c){s.finishedAt=new Date,s.error=c,this.onError(n,c,s)}}}z.Runner=d;async function y(m,n,s){try{await m(n)}catch(c){s(n,c)}}function v(m,n){const c=m.getNextMatch(n),r=new Date,w=c.getTime()-r.getTime();return w>864e5?864e5:Math.max(0,w)}function p(){const m=new Date;return m.setMilliseconds(0),m}return z}var F={},G={},oe={},Se;function at(){return Se||(Se=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=(()=>{const o=["january","february","march","april","may","june","july","august","september","october","november","december"],g=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function a(u,i){for(let h=0;h<i.length;h++)u=u.replace(new RegExp(i[h],"gi"),h+1);return u}function t(u){return u=a(u,o),u=a(u,g),u}return t})()),oe}var se={},Ie;function _e(){return Ie||(Ie=1,Object.defineProperty(se,"__esModule",{value:!0}),se.default=(()=>{const o=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],g=["sun","mon","tue","wed","thu","fri","sat"];function a(u,i){for(let h=0;h<i.length;h++)u=u.replace(new RegExp(i[h],"gi"),h);return u}function t(u){return u=u.replace("7","0"),u=a(u,o),a(u,g)}return t})()),se}var ae={},Ae;function ut(){return Ae||(Ae=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=(()=>{function o(a,t){return a.indexOf("*")!==-1?a.replace("*",t):a}function g(a){return a[0]=o(a[0],"0-59"),a[1]=o(a[1],"0-59"),a[2]=o(a[2],"0-23"),a[3]=o(a[3],"1-31"),a[4]=o(a[4],"1-12"),a[5]=o(a[5],"0-6"),a}return g})()),ae}var ue={},Be;function ct(){return Be||(Be=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=(()=>{function o(t,u,i,h,d){const y=parseInt(d),v=[];let p=parseInt(h),m=parseInt(i);m>p&&(p=parseInt(i),m=parseInt(h));for(let n=m;n<=p;n+=y)v.push(n);return t.replace(new RegExp(u,"i"),v.join())}function g(t){const u=/(\d+)-(\d+)(\/(\d+)|)/;let i=u.exec(t);for(;i!==null&&i.length>0;)t=o(t,i[0],i[1],i[2],i[4]||"1"),i=u.exec(t);return t}function a(t){for(let u=0;u<t.length;u++)t[u]=g(t[u]);return t}return a})()),ue}var qe;function ge(){if(qe)return G;qe=1;var o=G&&G.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(G,"__esModule",{value:!0});const g=o(at()),a=o(_e()),t=o(ut()),u=o(ct());return G.default=(()=>{function i(v){return v.length===5?["0"].concat(v):v}function h(v){return v.replace(/\s{2,}/g," ").trim()}function d(v){for(let p=0;p<v.length;p++){const m=v[p].split(",");for(let n=0;n<m.length;n++)m[n]=parseInt(m[n]);v[p]=m}return v}function y(v){let p=h(`${v}`).split(" ");return p=i(p),p[4]=(0,g.default)(p[4]),p[5]=(0,a.default)(p[5]),p=(0,t.default)(p),p=(0,u.default)(p),p=d(p),p}return y})(),G}var K={},Ce;function le(){if(Ce)return K;Ce=1,Object.defineProperty(K,"__esModule",{value:!0}),K.LocalizedTime=void 0;class o{timestamp;parts;timezone;constructor(u,i){this.timestamp=u.getTime(),this.timezone=i,this.parts=g(u,i)}toDate(){return new Date(this.timestamp)}toISO(){const u=this.parts.gmt.replace(/^GMT/,""),i=u||"Z",h=d=>String(d).padStart(2,"0");return`${this.parts.year}-${h(this.parts.month)}-${h(this.parts.day)}T${h(this.parts.hour)}:${h(this.parts.minute)}:${h(this.parts.second)}.${String(this.parts.milisecond).padStart(3,"0")}`+i}getParts(){return this.parts}set(u,i){this.parts[u]=i;const h=new Date(this.toISO());this.timestamp=h.getTime(),this.parts=g(h,this.timezone)}}K.LocalizedTime=o;function g(t,u){const i={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",hour12:!1};u&&(i.timeZone=u);const d=new Intl.DateTimeFormat("en-US",i).formatToParts(t).filter(y=>y.type!=="literal").reduce((y,v)=>(y[v.type]=v.value,y),{});return{day:parseInt(d.day),month:parseInt(d.month),year:parseInt(d.year),hour:d.hour==="24"?0:parseInt(d.hour),minute:parseInt(d.minute),second:parseInt(d.second),milisecond:t.getMilliseconds(),weekday:d.weekday,gmt:a(t,u)}}function a(t,u){const i=new Date(t.toLocaleString("en-US",{timeZone:"UTC"})),h=new Date(t.toLocaleString("en-US",{timeZone:u}));let d=(i.getTime()-h.getTime())/6e4;const y=d<=0?"+":"-";if(d=Math.abs(d),d===0)return"Z";const v=Math.floor(d/60).toString().padStart(2,"0"),p=Math.floor(d%60).toString().padStart(2,"0");return`GMT${y}${v}:${p}`}return K}var L={},je;function lt(){if(je)return L;je=1;var o=L&&L.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(L,"__esModule",{value:!0}),L.MatcherWalker=void 0;const g=o(ge()),a=le(),t=we(),u=o(_e());class i{cronExpression;baseDate;pattern;expressions;timeMatcher;timezone;constructor(y,v,p){this.cronExpression=y,this.baseDate=v,this.timeMatcher=new t.TimeMatcher(y,p),this.timezone=p,this.expressions=(0,g.default)(y)}isMatching(){return this.timeMatcher.match(this.baseDate)}matchNext(){const v=(()=>{const n=new Date(this.baseDate.getTime());n.setMilliseconds(0);const s=new a.LocalizedTime(n,this.timezone),c=s.getParts(),r=new a.LocalizedTime(s.toDate(),this.timezone),w=this.expressions[0],k=h(w,c.second);if(k&&(r.set("second",k),this.timeMatcher.match(r.toDate())))return r;r.set("second",w[0]);const M=this.expressions[1],D=h(M,c.minute);if(D&&(r.set("minute",D),this.timeMatcher.match(r.toDate())))return r;r.set("minute",M[0]);const E=this.expressions[2],A=h(E,c.hour);if(A&&(r.set("hour",A),this.timeMatcher.match(r.toDate())))return r;r.set("hour",E[0]);const B=this.expressions[3],S=h(B,c.day);if(S&&(r.set("day",S),this.timeMatcher.match(r.toDate())))return r;r.set("day",B[0]);const C=this.expressions[4],I=h(C,c.month);return I&&(r.set("month",I),this.timeMatcher.match(r.toDate()))||(r.set("year",r.getParts().year+1),r.set("month",C[0])),r})(),p=this.expressions[5];let m=parseInt((0,u.default)(v.getParts().weekday));for(;!(p.indexOf(m)>-1);)v.set("year",v.getParts().year+1),m=parseInt((0,u.default)(v.getParts().weekday));return v}}L.MatcherWalker=i;function h(d,y){const v=d.sort((p,m)=>p-m).filter(p=>p>y);return v.length>0?v[0]:!1}return L}var Ne;function we(){if(Ne)return F;Ne=1;var o=F&&F.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(F,"__esModule",{value:!0}),F.TimeMatcher=void 0;const g=o(ge()),a=o(_e()),t=le(),u=lt();function i(d,y){return d.indexOf(y)!==-1}class h{timezone;pattern;expressions;constructor(y,v){this.timezone=v,this.pattern=y,this.expressions=(0,g.default)(y)}match(y){const p=new t.LocalizedTime(y,this.timezone).getParts(),m=i(this.expressions[0],p.second),n=i(this.expressions[1],p.minute),s=i(this.expressions[2],p.hour),c=i(this.expressions[3],p.day),r=i(this.expressions[4],p.month),w=i(this.expressions[5],parseInt((0,a.default)(p.weekday)));return m&&n&&s&&c&&r&&w}getNextMatch(y){return new u.MatcherWalker(this.pattern,y,this.timezone).matchNext().toDate()}}return F.TimeMatcher=h,F}var Q={},$e;function Ve(){if($e)return Q;$e=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.StateMachine=void 0;const o={stopped:["stopped","idle","destroyed"],idle:["idle","running","stopped","destroyed"],running:["running","idle","stopped","destroyed"],destroyed:["destroyed"]};class g{state;constructor(t="stopped"){this.state=t}changeState(t){if(o[this.state].includes(t))this.state=t;else throw new Error(`invalid transition from ${this.state} to ${t}`)}}return Q.StateMachine=g,Q}var ze;function ft(){if(ze)return $;ze=1;var o=$&&$.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty($,"__esModule",{value:!0}),$.InlineScheduledTask=void 0;const g=o(U),a=st(),t=we(),u=pe(),i=Ve(),h=o(ve()),d=le();class y extends g.default{}class v{emitter;cronExpression;timeMatcher;runner;id;name;stateMachine;timezone;constructor(m,n,s){this.emitter=new y,this.cronExpression=m,this.id=(0,u.createID)("task",12),this.name=s?.name||this.id,this.timezone=s?.timezone,this.timeMatcher=new t.TimeMatcher(m,s?.timezone),this.stateMachine=new i.StateMachine;const c={timezone:s?.timezone,noOverlap:s?.noOverlap,maxExecutions:s?.maxExecutions,maxRandomDelay:s?.maxRandomDelay,beforeRun:(r,w)=>(w.reason==="scheduled"&&this.changeState("running"),this.emitter.emit("execution:started",this.createContext(r,w)),!0),onFinished:(r,w)=>(w.reason==="scheduled"&&this.changeState("idle"),this.emitter.emit("execution:finished",this.createContext(r,w)),!0),onError:(r,w,k)=>{h.default.error(w),this.emitter.emit("execution:failed",this.createContext(r,k)),this.changeState("idle")},onOverlap:r=>{this.emitter.emit("execution:overlap",this.createContext(r))},onMissedExecution:r=>{this.emitter.emit("execution:missed",this.createContext(r))},onMaxExecutions:r=>{this.emitter.emit("execution:maxReached",this.createContext(r)),this.destroy()}};this.runner=new a.Runner(this.timeMatcher,(r,w)=>n(this.createContext(r,w)),c)}getNextRun(){return this.stateMachine.state!=="stopped"?this.runner.nextRun():null}changeState(m){this.runner.isStarted()&&this.stateMachine.changeState(m)}start(){this.runner.isStopped()&&(this.runner.start(),this.stateMachine.changeState("idle"),this.emitter.emit("task:started",this.createContext(new Date)))}stop(){this.runner.isStarted()&&(this.runner.stop(),this.stateMachine.changeState("stopped"),this.emitter.emit("task:stopped",this.createContext(new Date)))}getStatus(){return this.stateMachine.state}destroy(){this.stateMachine.state!=="destroyed"&&(this.stop(),this.stateMachine.changeState("destroyed"),this.emitter.emit("task:destroyed",this.createContext(new Date)))}execute(){return new Promise((m,n)=>{const s=r=>{this.off("execution:finished",s),n(r.execution?.error)},c=r=>{this.off("execution:failed",s),m(r.execution?.result)};this.once("execution:finished",c),this.once("execution:failed",s),this.runner.execute()})}on(m,n){this.emitter.on(m,n)}off(m,n){this.emitter.off(m,n)}once(m,n){this.emitter.once(m,n)}createContext(m,n){const s=new d.LocalizedTime(m,this.timezone);return{date:s.toDate(),dateLocalIso:s.toISO(),triggeredAt:new Date,task:this,execution:n}}}return $.InlineScheduledTask=v,$}var Y={},Fe;function ht(){if(Fe)return Y;Fe=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.TaskRegistry=void 0;const o=new Map;class g{add(t){if(this.has(t.id))throw Error(`task ${t.id} already registred!`);o.set(t.id,t),t.on("task:destroyed",()=>{this.remove(t)})}get(t){return o.get(t)}remove(t){this.has(t.id)&&(t?.destroy(),o.delete(t.id))}all(){return o}has(t){return o.has(t)}killAll(){o.forEach(t=>this.remove(t))}}return Y.TaskRegistry=g,Y}var V={},Le;function dt(){if(Le)return V;Le=1;var o=V&&V.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(V,"__esModule",{value:!0});const g=o(ge()),a=/^(?:\d+|\*|\*\/\d+)$/;function t(n,s,c){const r=n;for(const w of r){const k=parseInt(w,10);if(!Number.isNaN(k)&&(k<s||k>c)||!a.test(w))return!1}return!0}function u(n){return!t(n,0,59)}function i(n){return!t(n,0,59)}function h(n){return!t(n,0,23)}function d(n){return!t(n,1,31)}function y(n){return!t(n,1,12)}function v(n){return!t(n,0,7)}function p(n,s){if(u(s[0]))throw new Error(`${n[0]} is a invalid expression for second`);if(i(s[1]))throw new Error(`${n[1]} is a invalid expression for minute`);if(h(s[2]))throw new Error(`${n[2]} is a invalid expression for hour`);if(d(s[3]))throw new Error(`${n[3]} is a invalid expression for day of month`);if(y(s[4]))throw new Error(`${n[4]} is a invalid expression for month`);if(v(s[5]))throw new Error(`${n[5]} is a invalid expression for week day`)}function m(n){if(typeof n!="string")throw new TypeError("pattern must be a string!");const s=n.split(" "),c=(0,g.default)(n);s.length===5&&s.unshift("0"),p(s,c)}return V.default=m,V}var Z={},Ue;function mt(){if(Ue)return Z;Ue=1;var o=Z&&Z.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Z,"__esModule",{value:!0});const g=U,a=U,t=pe(),u=U,i=Ve(),h=le(),d=o(ve()),y=we(),v=(0,g.resolve)(__dirname,"daemon.js");class p extends u.EventEmitter{}class m{emitter;id;name;cronExpression;taskPath;options;forkProcess;stateMachine;constructor(c,r,w){this.cronExpression=c,this.taskPath=r,this.options=w,this.id=(0,t.createID)("task"),this.name=w?.name||this.id,this.emitter=new p,this.stateMachine=new i.StateMachine("stopped"),this.on("task:stopped",()=>{this.forkProcess?.kill(),this.forkProcess=void 0,this.stateMachine.changeState("stopped")}),this.on("task:destroyed",()=>{this.forkProcess?.kill(),this.forkProcess=void 0,this.stateMachine.changeState("destroyed")})}getNextRun(){return this.stateMachine.state!=="stopped"?new y.TimeMatcher(this.cronExpression,this.options?.timezone).getNextMatch(new Date):null}start(){return new Promise((c,r)=>{if(this.forkProcess)return c(void 0);const w=setTimeout(()=>{r(new Error("Start operation timed out"))},5e3);try{this.forkProcess=(0,a.fork)(v),this.forkProcess.on("error",k=>{clearTimeout(w),r(new Error(`Error on daemon: ${k.message}`))}),this.forkProcess.on("exit",(k,M)=>{if(k!==0&&M!=="SIGTERM"){const D=new Error(`node-cron daemon exited with code ${k||M}`);d.default.error(D),clearTimeout(w),r(D)}}),this.forkProcess.on("message",k=>{if(k.jsonError&&k.context?.execution&&(k.context.execution.error=n(k.jsonError),delete k.jsonError),k.context?.task?.state&&this.stateMachine.changeState(k.context?.task?.state),k.context){const M=k.context?.execution;delete M?.hasError;const D=this.createContext(new Date(k.context.date),M);this.emitter.emit(k.event,D)}}),this.once("task:started",()=>{this.stateMachine.changeState("idle"),clearTimeout(w),c(void 0)}),this.forkProcess.send({command:"task:start",path:this.taskPath,cron:this.cronExpression,options:this.options})}catch(k){r(k)}})}stop(){return new Promise((c,r)=>{if(!this.forkProcess)return c(void 0);const w=setTimeout(()=>{clearTimeout(w),r(new Error("Stop operation timed out"))},5e3),k=()=>{clearTimeout(w),this.off("task:stopped",M),this.forkProcess=void 0,c(void 0)},M=()=>{k()};this.once("task:stopped",M),this.forkProcess.send({command:"task:stop"})})}getStatus(){return this.stateMachine.state}destroy(){return new Promise((c,r)=>{if(!this.forkProcess)return c(void 0);const w=setTimeout(()=>{clearTimeout(w),r(new Error("Destroy operation timed out"))},5e3),k=()=>{clearTimeout(w),this.off("task:destroyed",k),c(void 0)};this.once("task:destroyed",k),this.forkProcess.send({command:"task:destroy"})})}execute(){return new Promise((c,r)=>{if(!this.forkProcess)return r(new Error("Cannot execute background task because it hasn't been started yet. Please initialize the task using the start() method before attempting to execute it."));const w=setTimeout(()=>{k(),r(new Error("Execution timeout exceeded"))},5e3),k=()=>{clearTimeout(w),this.off("execution:finished",M),this.off("execution:failed",D)},M=E=>{k(),c(E.execution?.result)},D=E=>{k(),r(E.execution?.error||new Error("Execution failed without specific error"))};this.once("execution:finished",M),this.once("execution:failed",D),this.forkProcess.send({command:"task:execute"})})}on(c,r){this.emitter.on(c,r)}off(c,r){this.emitter.off(c,r)}once(c,r){this.emitter.once(c,r)}createContext(c,r){const w=new h.LocalizedTime(c,this.options?.timezone);return{date:w.toDate(),dateLocalIso:w.toISO(),triggeredAt:new Date,task:this,execution:r}}}function n(s){const c=JSON.parse(s),r=globalThis[c.name]||Error,w=new r(c.message);return c.stack&&(w.stack=c.stack),Object.keys(c).forEach(k=>{["name","message","stack"].includes(k)||(w[k]=c[k])}),w}return Z.default=m,Z}var We;function yt(){return We||(We=1,function(o){var g=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(o,"__esModule",{value:!0}),o.nodeCron=o.getTask=o.getTasks=void 0,o.schedule=v,o.createTask=p,o.solvePath=m,o.validate=n;const a=ft(),t=ht(),u=g(dt()),i=g(mt()),h=g(U),d=U,y=new t.TaskRegistry;function v(s,c,r){const w=p(s,c,r);return w.start(),w}function p(s,c,r){let w;if(c instanceof Function)w=new a.InlineScheduledTask(s,c,r);else{const k=m(c);w=new i.default(s,k,r)}return y.add(w),w}function m(s){if(h.default.isAbsolute(s))return(0,d.pathToFileURL)(s).href;if(s.startsWith("file://"))return s;const c=new Error().stack?.split(`
`);if(c){c?.shift();const w=c?.find(k=>k.indexOf(__filename)===-1)?.match(/(file:\/\/)?(((\/?)(\w:))?([/\\].+)):\d+:\d+/);if(w){const k=`${w[5]??""}${h.default.dirname(w[6])}`;return(0,d.pathToFileURL)(h.default.resolve(k,s)).href}}throw new Error(`Could not locate task file ${s}`)}function n(s){try{return(0,u.default)(s),!0}catch{return!1}}o.getTasks=y.all,o.getTask=y.get,o.nodeCron={schedule:v,createTask:p,validate:n,getTasks:o.getTasks,getTask:o.getTask},o.default=o.nodeCron}(J)),J}var Ze=yt();const pt=ce(Ze),kt=He({__proto__:null,default:pt},[Ze]);export{it as _,bt as b,gt as i,kt as n,_t as r,wt as s};
