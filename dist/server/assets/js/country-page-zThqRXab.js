import{jsx as e,jsxs as c,Fragment as ue}from"react/jsx-runtime";import{lazy as h,useState as N,useEffect as q,useMemo as pe,Suspense as w}from"react";import{useTranslation as he}from"react-i18next";import{H as fe}from"./react-vendor-DuXzSgbK.js";import{S as H,B as ye,C as be,H as xe}from"./components-0JP6n3jk.js";import{dataService as _e}from"./data-service-CydxH5Qr.js";import{c as we,d as ve,e as Ne,h as Se,i as Ce,j as ke,k as Pe,l as $e,B as W,a as Q,b as De}from"./utils-vRJ5uFnM.js";import{P as Be}from"./plan-components-D0_vZHhI.js";import{C as Ie,B as Ue,g as J,A as Ee}from"./constants-Ct2pKzgS.js";import{FaBolt as Ae,FaGlobe as je,FaMoneyBillWave as Fe,FaRegComments as Ge}from"react-icons/fa";import{D as Re}from"./compatibility-DZ9RMvVY.js";const Te=h(()=>import("./components-0JP6n3jk.js").then(r=>r.h)),Me=h(()=>import("./components-0JP6n3jk.js").then(r=>r.g)),Le=h(()=>import("./components-0JP6n3jk.js").then(r=>r.i)),Oe=h(()=>import("./compatibility-DZ9RMvVY.js").then(r=>r.a)),ze=h(()=>import("./components-0JP6n3jk.js").then(r=>r.j));h(()=>import("./components-0JP6n3jk.js").then(r=>r.f));const qe=h(()=>import("./testimonials-Cim931OJ.js"));h(()=>import("./components-0JP6n3jk.js").then(r=>r.k));const He=h(()=>import("./components-0JP6n3jk.js").then(r=>r.l)),We=h(()=>import("./plan-components-D0_vZHhI.js").then(r=>r.C));h(()=>import("./components-0JP6n3jk.js").then(r=>r.m));const j=r=>r==="USD"?"$":r,S=()=>c("div",{className:"animate-pulse p-4",children:[e("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),lt=({countryId:r,navigateTo:P=()=>{}})=>{const{t:i,i18n:m}=he(["countries","home","common","faq","esim_info"]),o=(t,a={})=>i(t,{ns:"countries",...a}),s=(t,a)=>{try{const l=i(`countries.${t}`,{ns:"countries"});return l!==`countries.${t}`?l:a}catch(l){return console.error("Translation error:",l),a}},[V,K]=N(!1),[X,Y]=N(!1),[Z,B]=N(!1),[$,I]=N(null),[ee,F]=N(null),[G,te]=N(!0),[d,ne]=N(null),n=Ie.find(t=>t.id===r),f=n?.countryCode||n?.id.toUpperCase()||"US";if(!n)return console.error("Country not found:",r),e(NotFoundPage,{navigateTo:P});q(()=>{const t=()=>{K(window.scrollY>300)};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]),q(()=>((async()=>{try{let a="global-speed-test.json";m.language==="zh"?a="global-speed-test-zh.json":m.language==="bg"&&(a="global-speed-test-bg.json");const[l,u]=await Promise.all([De.getNormalizedPlansData(),fetch(`/data/${a}`)]);let g=null;if(u.ok)g=await u.json();else{const x=await fetch("/data/global-speed-test.json");x.ok&&(g=await x.json())}console.log("CountryPage: Enhanced plans loaded:",l?.items?.length||0,"total plans");const b=l?.items?.filter(x=>x.source==="saily")||[],k=l?.items?.filter(x=>x.source==="local")||[];console.log("CountryPage: Breakdown -",b.length,"Saily plans,",k.length,"local plans");const _=b.find(x=>x.covered_countries?.includes(f));_&&(console.log("DEBUG: Sample plan for",f,":",_),console.log("DEBUG: Sample plan price:",_.price),console.log("DEBUG: Sample plan price.identifier:",_.price?.identifier)),console.log("CountryPage: Speed data loaded:",!!g),I(l),F(g)}catch(a){console.error("Error loading data:",a);try{const l=await _e.getPlansData(!0);console.log("CountryPage: Using fallback plans data:",l?.items?.length||0,"plans"),I(l)}catch(l){console.error("CountryPage: Fallback also failed:",l),I({items:[]})}F(null)}finally{console.log("CountryPage: Setting loading to false"),te(!1)}})(),()=>{}),[m.language]);const U=typeof window>"u"||!window.document||!window.document.createElement,R=!U&&G,D=$||{items:[]},v=pe(()=>!D?.items||!f?[]:D.items.filter(t=>!!t.covered_countries.includes(f)),[D,f]);if(R)return c("div",{className:"min-h-screen",children:[e(H,{type:"hero"}),e("div",{className:"container mx-auto px-4 py-8",children:e(H,{type:"grid",count:6})})]});const ae=((t,a)=>{const l=a==="bg"?`${t} е на 101-во място глобално с медианна мобилна скорост за изтегляне от 95.5 Mbps.`:`Ranked #101, ${t} has a median mobile download speed of 95.5 Mbps.`;return{country_rankings:[{rank:101,country:t,speed_mbps:95.5,explanation:l}]}})(s(n.id,n.name),m.language),oe=U?ae:ee;if(!n)return c("div",{className:"container mx-auto px-4 py-8",children:[c("h1",{className:"text-2xl font-bold text-center",children:[i("common.error")," - ",i("countries.country_not_found")]}),e("p",{className:"text-center text-gray-600",children:i("countries.country_not_exist")})]});if(R)return e("div",{className:"container mx-auto px-4 py-8",children:c("div",{className:"animate-pulse",children:[e("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})});console.log("CountryPage: Filtering plans for country:",f),console.log("CountryPage: Total plans in data:",D?.items?.length||0),console.log("CountryPage: Filtered country plans:",v.length);const re=v.filter(t=>t.region),ie=v.filter(t=>!t.region);if(console.log("CountryPage: Regional plans:",re.length,"Country-specific:",ie.length),!U&&!G&&v.length===0&&$?.items){const t=["NA","CA","US","MX"],a=["AI","AG","AW","BS","BB","BM","CW","VG","DM","GD","HT","JM","MS","PA","PR","BL","GF","GP","MF","MQ","KN","LC","TT","TC","BQ","KY","SX","VC"];$.items.some(u=>u.covered_countries.some(g=>t.includes(g)||a.includes(g)))&&console.log("CountryPage: No direct plans; regional/caribbean plans exist for this market.")}const E={};v.forEach(t=>{let a="country";const l=Array.isArray(t.covered_countries)?t.covered_countries.length:0;if(l>=50?a="global":l>1?a="regional":a="country",a!=="country"||!Array.isArray(t.covered_countries)||t.covered_countries.length!==1||t.covered_countries[0]!==f)return;const u=a==="country"?t.covered_countries?.[0]||"NA":a==="regional"?t.region||"multi":"global",g=`${a}|${u}|${t.data_amount}-${t.data_unit}-${t.validity_days}|${t.price?.amount_with_tax}`,b=E[g];(!b||(t.price?.amount_with_tax??1/0)<(b.price?.amount_with_tax??1/0))&&(E[g]=t)});const T=Object.values(E);console.log("CountryPage: Total plans after smart-dedup:",T.length);const y=T.map(t=>{let a="country";return Array.isArray(t.covered_countries)&&t.covered_countries.length>=50?a="global":Array.isArray(t.covered_countries)&&t.covered_countries.length>1?a="regional":a="country",{id:t.identifier,name:t.name,data_amount:t.data_amount,data_unit:t.data_unit,validity_days:t.validity_days,price:{amount_with_tax:t.price.amount_with_tax,currency:t.price.currency},covered_countries:t.covered_countries,identifier:t.identifier,data:t.data,validity:t.validity,planType:a,region:t.region}}),le=y[0]?.id?String(y[0].id):void 0,C=y.length>0?y.reduce((t,a)=>a.price.amount_with_tax<t.price.amount_with_tax?a:t,y[0]):null,M=C&&isFinite(C.price.amount_with_tax)?`${j(C.price.currency)}${C.price.amount_with_tax/100}`:null,se=n.name.toLowerCase(),ce=s(n.id,n.name).toLowerCase(),L=oe?.country_rankings?.find(t=>{const a=String(t.country||"").toLowerCase();return a===se||a===ce})?.explanation??null,de=[o("fast_reliable"),o("stay_connected_networks",{region:s(n.id,n.name)}),o("compatible_smartphones"),M?o("data_plans_from",{price:M}):o("affordable_flexible_plans")],O=t=>({europe:o("regions.europe"),asia:o("regions.asia"),"north-america":o("regions.north-america"),"south-america":o("regions.south-america"),africa:o("regions.africa"),oceania:o("regions.oceania")})[t]||o("region"),me=[{label:o("region_travel_esim",{region:O(n.regionId)}),url:m.language==="zh"?`/zh/${n.regionId}`:`/${n.regionId}`},{label:s(n.id,n.name)}],z=()=>{if(typeof window<"u"&&typeof window.gtag=="function"&&window.gtag("event","buy_esim_click",{country:s(n.id,n.name),plan:d?.id,upsell:X}),d){console.log("DEBUG: selectedPlan in handleBuyClick:",d),console.log("DEBUG: selectedPlan.price:",d.price),console.log("DEBUG: selectedPlan.price.identifier:",d.price?.identifier),console.log("DEBUG: typeof selectedPlan.price:",typeof d.price),console.log("DEBUG: Object.keys(selectedPlan.price):",Object.keys(d.price||{}));const t=d.price&&typeof d.price=="object"&&"identifier"in d.price?d.price.identifier:void 0;console.log("DEBUG: Extracted priceIdentifier:",t),console.log("DEBUG: selectedPlan.identifier (plan UUID):",d.identifier);const a={country:s(n.id,n.name),flag:Q(f),data:d.data,validity:d.validity,price:d.price.amount_with_tax/100,currency:j(d.currency||d.price.currency||"USD"),identifier:d.identifier,priceIdentifier:t};console.log("DEBUG: planData being sent to checkout:",a);const l=encodeURIComponent(JSON.stringify(a));P(`/checkout?plan=${l}`)}};return c(ue,{children:[c(fe,{children:[e("html",{lang:m.language==="bg"?"bg":"en"}),e("title",{children:o("meta.title_template",{country:s(n.id,n.name),price:C?`$${(C.price.amount_with_tax/100).toFixed(2)}`:""})||o("meta.title_fallback",{country:s(n.id,n.name)})}),e("meta",{name:"description",content:o("meta.description_template",{country:s(n.id,n.name)})}),e("meta",{name:"keywords",content:o("meta.keywords_template",{country:s(n.id,n.name)})}),e("meta",{property:"og:title",content:o("meta.og_title_template",{country:s(n.id,n.name)})}),e("meta",{property:"og:description",content:o("meta.og_description_template",{country:s(n.id,n.name)})}),e("meta",{property:"og:type",content:"website"}),e("meta",{property:"og:url",content:`https://travelesim.bg/${n.regionId}/${n.slug}`}),e("meta",{property:"og:image",content:"https://travelesim.bg/esim-data/travelesim-logo.png"}),e("meta",{property:"og:locale",content:m.language==="bg"?"bg_BG":"en_US"}),e("meta",{property:"og:locale:alternate",content:m.language==="bg"?"en_US":"bg_BG"}),e("meta",{name:"twitter:card",content:"summary_large_image"}),e("meta",{name:"twitter:title",content:o("meta.twitter_title_template",{country:s(n.id,n.name)})}),e("meta",{name:"twitter:description",content:o("meta.twitter_description_template",{country:s(n.id,n.name)})}),e("link",{rel:"canonical",href:`https://travelesim.bg${m.language==="en"?"/en":""}/${n.regionId}/${n.slug}`}),e("link",{rel:"alternate",hrefLang:"bg",href:`https://travelesim.bg/${n.regionId}/${n.slug}`}),e("link",{rel:"alternate",hrefLang:"en",href:`https://travelesim.bg/en/${n.regionId}/${n.slug}`}),e("link",{rel:"alternate",hrefLang:"x-default",href:`https://travelesim.bg/${n.regionId}/${n.slug}`})]}),e("script",{type:"application/ld+json",children:JSON.stringify((()=>{const t=s(n.id,n.name),a=`${Ue}${m.language==="en"?"/en":""}/${n.regionId}/${n.slug}`,l=`${a}/#country`,u=`${a}/#breadcrumb`,g=`${a}/#product`,b=`https://en.wikipedia.org/wiki/${encodeURIComponent(t.replace(/\s+/g,"_"))}`,k=y.map(p=>p.price.amount_with_tax/100).filter(p=>Number.isFinite(p)),_=k.length?Math.min(...k).toFixed(2):void 0,x=k.length?Math.max(...k).toFixed(2):void 0,A=y.map(p=>({"@type":"Offer","@id":`${a}/#offer-${p.id}`,sku:p.id,name:p.name,price:(p.price.amount_with_tax/100).toFixed(2),priceCurrency:p.price.currency||"USD",availability:"https://schema.org/InStock",eligibleRegion:{"@id":l},itemOffered:{"@id":g},url:`${a}#plans`})),ge=J(t,n.id,i,$).slice(0,8);return{"@context":"https://schema.org","@graph":[we(i,m.language),ve(i,m.language),Ne(i,m.language,a,o("meta.title_template",{country:t,price:_?`$${_}`:""})||o("meta.title_fallback",{country:t}),o("meta.description_template",{country:t}),l,u),Se(i,m.language,a,[{name:i("breadcrumbs.home",{ns:"common"}),item:`${W}/`},{name:o("region_travel_esim",{region:O(n.regionId)}),item:`${W}/${n.regionId}`},{name:`${t} eSIM`,item:a}]),Ce(i,m.language,a,t,"Country",f,[b]),ke(i,m.language,a,`${t} eSIM`,o("meta.description_template",{country:t}),A),Pe(i,m.language,a,y[0]?.price?.currency||"USD",_||"0",x||"0",A.length,A.map(p=>p["@id"])),$e(i,m.language,a,ge)]}})())}),c("div",{className:"bg-white",children:[e(ye,{items:me,navigateTo:P}),e("div",{className:"w-full bg-black text-white py-8 md:py-16",children:e("div",{className:"w-full max-w-[90vw] mx-auto px-2 sm:px-4",children:c("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 lg:gap-16 items-center justify-center",children:[c("div",{className:"lg:col-span-1 flex flex-col justify-center text-left px-2 sm:px-4",children:[c("div",{className:"flex flex-col sm:flex-row items-start mb-6 gap-3 sm:gap-4 w-full",children:[e("span",{className:"inline-flex items-center justify-center",style:{width:56,height:56,borderRadius:"50%",overflow:"hidden",boxShadow:"0 0 0 4px rgba(100,100,150,0.5), 0 0 0 8px #23225a",boxSizing:"border-box",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e("img",{src:Q(f),alt:`${s(n.id,n.name)} flag`,loading:"eager",width:"56",height:"56",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%",display:"block"}})}),e("h1",{className:"text-4xl md:text-6xl font-extrabold text-white text-left",children:o("esim_for_country",{country:s(n.id,n.name)})})]}),e("p",{className:"text-base sm:text-lg md:text-xl text-gray-200 mb-2 sm:mb-4 text-left",children:o("country_tagline",{country:s(n.id,n.name)})}),L&&c("figure",{className:"mb-6 sm:mb-8",children:[e("blockquote",{className:"bg-gray-800 rounded-lg p-4 border-l-4 border-blue-500",children:c("p",{className:"italic text-gray-200 text-base",children:['"',L,'"']})}),c("figcaption",{className:"mt-2 text-right text-sm text-gray-400",children:["- ",i("network_performance.speedtest_global_index",{ns:"esim_info"})]})]}),e("ul",{className:"space-y-2 mb-6 sm:mb-8 text-white text-left",children:de.map((t,a)=>e(Qe,{text:t},a))})]}),e("div",{className:"w-full rounded-none shadow-none p-0 m-0 border-0 sm:rounded-2xl sm:shadow-lg sm:p-8 flex flex-col justify-center items-center lg:sticky lg:top-24",style:{boxSizing:"border-box"},children:e(Be,{plans:y,selectedPlan:d,onSelectPlan:t=>ne(t),countryName:s(n.id,n.name),bestValuePlanId:le,onUpsellChange:Y,onBuyNow:z,onCheckCompatibility:()=>B(!0)})})]})})}),e(w,{fallback:e(S,{}),children:e(We,{plans:y,countryName:s(n.id,n.name)})}),c("div",{className:"max-w-5xl mx-auto mt-20 md:mt-32 space-y-20 md:space-y-28",children:[e(be,{countryName:s(n.id,n.name)}),e(xe,{countryName:s(n.id,n.name)}),e("section",{className:"bg-gray-50 py-20",children:c("div",{className:"container mx-auto px-4",children:[e("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-6",children:i("why_choose_our_esims.title")}),e("p",{className:"text-center text-lg text-gray-600 mb-12",children:(()=>{const t=v.length>0?v.reduce((g,b)=>b.price<g.price?b:g):null,a=t?`${j(t.price.currency)}${t.price.amount_with_tax/100}`:"",l=s(n.id,n.name);let u=i("why_choose_our_esims.description");return u=u.replace("{country}",l),u=u.replace("{lewest-price}",a),u})()}),c("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 text-center max-w-6xl mx-auto",children:[c("div",{className:"flex flex-col items-center p-4",children:[e("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mb-4",children:e(Ae,{className:"text-3xl text-blue-500"})}),e("h3",{className:"text-lg font-bold mb-2",children:i("why_choose_our_esims.instant_connectivity.title")}),e("p",{className:"text-gray-600",children:i("why_choose_our_esims.instant_connectivity.description")})]}),c("div",{className:"flex flex-col items-center p-4",children:[e("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mb-4",children:e(je,{className:"text-3xl text-blue-500"})}),e("h3",{className:"text-lg font-bold mb-2",children:i("why_choose_our_esims.global_coverage.title")}),e("p",{className:"text-gray-600",children:i("why_choose_our_esims.global_coverage.description")})]}),c("div",{className:"flex flex-col items-center p-4",children:[e("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mb-4",children:e(Fe,{className:"text-3xl text-blue-500"})}),e("h3",{className:"text-lg font-bold mb-2",children:i("why_choose_our_esims.affordable_transparent.title")}),e("p",{className:"text-gray-600",children:i("why_choose_our_esims.affordable_transparent.description")})]}),c("div",{className:"flex flex-col items-center p-4",children:[e("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mb-4",children:e(Ge,{className:"text-3xl text-blue-500"})}),e("h3",{className:"text-lg font-bold mb-2",children:i("why_choose_our_esims.chat_support.title")}),e("p",{className:"text-gray-600",children:i("why_choose_our_esims.chat_support.description")})]})]})]})}),e(w,{fallback:e(S,{}),children:e(Oe,{onCheckCompatibility:()=>B(!0)})}),e(Re,{isOpen:Z,onClose:()=>B(!1)}),e(w,{fallback:e(S,{}),children:e(qe,{})})]}),e(w,{fallback:e(S,{}),children:e(ze,{country:n})}),V&&e(w,{fallback:null,children:e(He,{onClick:z})}),c("div",{className:"px-4 py-12 md:px-8",children:[e("h2",{className:"text-3xl md:text-[36px] font-bold text-center text-gray-900 mb-10",children:o("frequently_asked_questions")}),e(w,{fallback:e(S,{}),children:e(Te,{faqs:J(s(n.id,n.name),r,i,$)})}),e("div",{className:"mt-12",children:e(w,{fallback:e(S,{}),children:e(Me,{author:Ee,navigateTo:P})})})]}),e(w,{fallback:e(S,{}),children:e(Le,{navigateTo:P})})]})]})},Qe=({text:r})=>c("li",{className:"flex items-center text-lg text-white",children:[e("svg",{className:"w-6 h-6 text-green-500 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r]});export{lt as C};
